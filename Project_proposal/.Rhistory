library(tidyverse)
library(readxl)
#Loading data
data <- "ms_metadata.xlsx"
ms_data <- read_excel(data)
ms_data
#Renaming sample ID column
colnames(ms_data)[1] <- "sample_id"
#filtering for healthy and asthma
#Selecting for MS and asthma
selected <- select(ms_data, sample_id, disease_course, asthma)
selected
#filtering for healthy and asthma
filtered_asthma <- filter(selected, disease_course == "Control", asthma == 1)
filtered_asthma
#Filtering for PPMS
filtered_PPMS <- filter(selected, disease_course == "PPMS")
filtered_PPMS
#Filtering for asthma within PPMS
filtered_PPMS_asthma <- filter(filtered_PPMS, asthma == 1)
filtered_PPMS_asthma
#Filtering for RRMS
rrms_filtered <- filter(selected, disease_course == "RRMS")
rrms_filtered
#Filtering for asthma within RRMS
rrms_asthma_filtered <- filter(rrms_filtered, asthma == 1)
rrms_asthma_filtered
#Removing duplicated sample IDs
rrms_asthma_filtered_unique <- unique(rrms_asthma_filtered)
rrms_asthma_filtered_unique
#Counting the number of rows from both RRMS and PPMS + asthma
nrow(rrms_asthma_filtered_unique)
nrow(filtered_PPMS_asthma)
nrow(filtered_asthma)
View(selected)
View(filtered_asthma)
View(rrms_filtered)
View(ms_data)
#### Removing Unwanted Variables and Selecting Samples for Analysis ####
# remove duplicates from data
unique(ms_data)
View(ms_data)
#### Removing Unwanted Variables and Selecting Samples for Analysis ####
# remove duplicates from data
ms_no_dbl <- unique(ms_data)
#remove unwanted varibles
ms_clean <-
?filter
#remove unwanted varibles
ms_clean <- select(ms_no_dbl, "sample_id","site_x","sex","age","bmi",
"disease_course","disease_duration","treatment_status",
"treatments","administration","MSSS","dmt","birth_method",
"breastfeeding","allergies","asthma","ms_family","nsaids",
"smoke","education","occupation","vitamin D (IU)")
View(ms_clean)
#create RRMS and asmtha group
rrms_asthma <- filter(ms_clean, disease_course =="RRMS", asthma == 1)
View(rrms_asthma)
library(dplyr)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample(38)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample(38, replace = TRUE)
View(rrms_no_asthma)
?sample
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample(38)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample(38)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0)
View(rrms_no_asthma)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample_n(38)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample_n(38)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample_n(38)
#create RRMS, no asthma group
set.seed(9)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample_n(38)
healthy_asthma <- filter(ms_clean, disease_course =="Control", asthma ==1)
View(healthy_asthma)
#create healthy, asthma group
healthy_asthma <- filter(ms_clean, disease_course =="Control", asthma ==1) %>%
sample_n(38)
healthy_no_asthma <- filter(ms_clean, disease_course =="Control", asthma ==0)
#create healthy, no asthma group
healthy_no_asthma <- filter(ms_clean, disease_course =="Control", asthma ==0) %>%
sample_n(38)
library(tidyverse)
library(readxl)
library(dplyr)
#combine all 4 groups into 1 data frame
ms_final_dat <- full_join(rrms_asthma, rrms_no_asthma,healthy_asthma,healthy_no_asthma)
library(tidyverse)
library(readxl)
library(dplyr)
#Loading data
data <- "ms_metadata.xlsx"
ms_data <- read_excel(data)
ms_data
#### Preliminary Filtering to Determine Sample Size ####
#Renaming sample ID column
colnames(ms_data)[1] <- "sample_id"
#filtering for healthy and asthma
#Selecting for MS and asthma
selected <- select(ms_data, sample_id, disease_course, asthma)
selected
#filtering for healthy and asthma
filtered_asthma <- filter(selected, disease_course == "Control", asthma == 1)
filtered_asthma
#Filtering for PPMS
filtered_PPMS <- filter(selected, disease_course == "PPMS")
filtered_PPMS
#Filtering for asthma within PPMS
filtered_PPMS_asthma <- filter(filtered_PPMS, asthma == 1)
filtered_PPMS_asthma
#Filtering for RRMS
rrms_filtered <- filter(selected, disease_course == "RRMS")
rrms_filtered
#Filtering for asthma within RRMS
rrms_asthma_filtered <- filter(rrms_filtered, asthma == 1)
rrms_asthma_filtered
#Removing duplicated sample IDs
rrms_asthma_filtered_unique <- unique(rrms_asthma_filtered)
rrms_asthma_filtered_unique
#Counting the number of rows from both RRMS and PPMS + asthma
nrow(rrms_asthma_filtered_unique)
nrow(filtered_PPMS_asthma)
nrow(filtered_asthma)
#### Removing Unwanted Variables and Selecting Samples for Analysis ####
# remove duplicates from data
ms_no_dbl <- unique(ms_data)
#remove unwanted variables
ms_clean <- select(ms_no_dbl, "sample_id","site_x","sex","age","bmi",
"disease_course","disease_duration","treatment_status",
"treatments","administration","MSSS","dmt","birth_method",
"breastfeeding","allergies","asthma","ms_family","nsaids",
"smoke","education","occupation","vitamin D (IU)")
#create RRMS and asthma group
rrms_asthma <- filter(ms_clean, disease_course =="RRMS", asthma == 1)
#create RRMS, no asthma group
set.seed(9)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample_n(38)
#create healthy, asthma group
healthy_asthma <- filter(ms_clean, disease_course =="Control", asthma ==1) %>%
sample_n(38)
#create healthy, no asthma group
healthy_no_asthma <- filter(ms_clean, disease_course =="Control", asthma ==0) %>%
sample_n(38)
#combine all 4 groups into 1 data frame
ms_final_dat <- full_join(rrms_asthma, rrms_no_asthma, healthy_asthma, healthy_no_asthma)
#combine all 4 groups into 1 data frame
ms_final_dat <- full_join(rrms_asthma, rrms_no_asthma)
View(ms_final_dat)
#combine all 4 groups into 1 data frame
ms_final_dat <- full_join(rrms_asthma, rrms_no_asthma) %>%
full_join(healthy_asthma)
#combine all 4 groups into 1 data frame
ms_final_dat <- full_join(rrms_asthma, rrms_no_asthma) %>%
full_join(healthy_asthma) %>%
full_join(healthy_no_asthma)
#export the final data frame as a tsv file
write_delim(ms_final_dat, "ms_metadata_final", delim = "\t")
#export the final data frame as a tsv file
write_delim(ms_final_dat, "ms_metadata_final.tsv", delim = "\t")
?write_delim
write_delim(ms_final_dat, "ms_metadata_final.csv", delim = "\,")
write_delim(ms_final_dat, "ms_metadata_final.csv", delim = ",")
#export the final data frame as a tsv file and a csv file
write_delim(ms_final_dat, "ms_metadata_final.tsv", delim = "\t")
library(tidyverse)
library(readxl)
library(dplyr)
#Loading data
data <- "ms_metadata.xlsx"
ms_data <- read_excel(data)
ms_data
#Renaming sample ID column
colnames(ms_data)[1] <- "sample_id"
#### Removing Unwanted Variables and Selecting Samples for Analysis ####
# remove duplicates from data
ms_no_dbl <- unique(ms_data)
#remove unwanted variables
ms_clean <- select(ms_no_dbl, "sample_id","site_x","sex","age","bmi",
"disease_course","disease_duration","treatment_status",
"treatments","administration","MSSS","dmt","birth_method",
"breastfeeding","allergies","asthma","ms_family","nsaids",
"smoke","education","occupation","vitamin D (IU)")
#create RRMS and asthma group
rrms_asthma <- filter(ms_clean, disease_course =="RRMS", asthma == 1)
#create RRMS, no asthma group
set.seed(9)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample_n(38)
#create healthy, asthma group
healthy_asthma <- filter(ms_clean, disease_course =="Control", asthma ==1) %>%
sample_n(38)
#create healthy, no asthma group
healthy_no_asthma <- filter(ms_clean, disease_course =="Control", asthma ==0) %>%
sample_n(38)
#combine all 4 groups into 1 data frame
ms_final_dat <- full_join(rrms_asthma, rrms_no_asthma) %>%
full_join(healthy_asthma) %>%
full_join(healthy_no_asthma)
#export the final data frame as a tsv file and a csv file
write_delim(ms_final_dat, "ms_metadata_final.tsv", delim = "\t")
write_delim(ms_final_dat, "ms_metadata_final.csv", delim = ",")
library(tidyverse)
library(readxl)
library(dplyr)
data <- "ms_metadata.xlsx"
ms_data <- read_excel(data)
ms_data
# remove duplicates from data
ms_no_dbl <- unique(ms_data)
#remove unwanted variables
ms_clean <- select(ms_no_dbl, "sample-id","site_x","sex","age","bmi",
"disease_course","disease_duration","treatment_status",
"treatments","administration","MSSS","dmt","birth_method",
"breastfeeding","allergies","asthma","ms_family","nsaids",
"smoke","education","occupation","vitamin D (IU)")
#create RRMS and asthma group
rrms_asthma <- filter(ms_clean, disease_course =="RRMS", asthma == 1)
ms_clean
#create RRMS and asthma group
rrms_asthma <- filter(ms_clean, disease_course =="RRMS", asthma == 1)
#create RRMS, no asthma group
set.seed(9)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample_n(38)
#create healthy, asthma group
healthy_asthma <- filter(ms_clean, disease_course =="Control", asthma ==1) %>%
sample_n(38)
#create healthy, no asthma group
healthy_no_asthma <- filter(ms_clean, disease_course =="Control", asthma ==0) %>%
sample_n(38)
#combine all 4 groups into 1 data frame
ms_final_dat <- full_join(rrms_asthma, rrms_no_asthma) %>%
full_join(healthy_asthma) %>%
full_join(healthy_no_asthma)
#export the final data frame as a tsv file and a csv file
write_delim(ms_final_dat, "ms_metadata_final.tsv", delim = "\t")
write_delim(ms_final_dat, "ms_metadata_final.csv", delim = ",")
sum(c(TRUE, TRUE, FALSE))
e <- c("matrix(ncol=10, nrow =10)"
c("matrix(ncol-10, nrow=10)")
b <- list(name1 = c("string1","string2"))
typeof(b)
e <- c("matrix(ncol=10, nrow =10)")
typeof(e)
d <- c("1")
typeof(d)
a <- 1
b <- "chen"
c <- -4.5
d <- "-4.5"
e <- TRUE
f <- FALSE
#### Vectors are collections of ONE variable type
# This will work
c("Melissa","David","Maxine")
# Is the same as:
fam <- data.frame(names = c("Melissa","David", "Maxine", "Braelyn")
, age = c(103, 103, 1,7)
, human = c(TRUE, TRUE, FALSE, FALSE))
fam[,1]
fam[1,]
fam[1,2]
# Removing contents of data frame
fam_2023 <- fam[-4,]
View(fam)
View(fam_2023)
fam_2 <- fam[,-3]
View(fam_2)
# Load packages
library(tidyverse)
# Load metadata
sampdatfp <- "atacamasoil_sample-data.txt"
sampdat <- read.delim(sampdatfp)
str(sampdat)
sampdat <- read.delim(sampdatfp)
sampdat <- read.delim(sampdatfp)
library(tidyverse)
library(readxl)
library(dplyr)
data <- "ms_metadata.xlsx"
ms_data <- read_excel(data)
#### Removing Unwanted Variables and Selecting Samples for Analysis ####
# remove duplicates from data
ms_no_dbl <- unique(ms_data)
View(ms_no_dbl)
#remove unwanted variables
ms_clean <- select(ms_no_dbl, "sample-id","sex","age",
"disease_course","treatment_status",
"asthma","smoke")
#create RRMS and asthma group
rrms_asthma <- filter(ms_clean, disease_course =="RRMS", asthma == 1)
#create RRMS, no asthma group
set.seed(9)
rrms_no_asthma <- filter(ms_clean, disease_course =="RRMS", asthma ==0) %>%
sample_n(38)
#create healthy, asthma group
healthy_asthma <- filter(ms_clean, disease_course =="Control", asthma ==1) %>%
sample_n(38)
#create healthy, no asthma group
healthy_no_asthma <- filter(ms_clean, disease_course =="Control", asthma ==0) %>%
sample_n(38)
#combine all 4 groups into 1 data frame
ms_final_dat <- full_join(rrms_asthma, rrms_no_asthma) %>%
full_join(healthy_asthma) %>%
full_join(healthy_no_asthma)
View(ms_final_dat)
#export the final data frame as a tsv file and a csv file
write_delim(ms_final_dat, "ms_metadata_final.tsv", delim = "\t")
## reconciling manifest based on filtered metadata
ms_metadata_final<- read_tsv("ms_metadata_final.tsv")
ms_manifest<-read_tsv("ms_manifest.tsv")
ms_manifest<-read_tsv("ms_manifest.tsv")
# taking only the sample-id column
filtered_metadata_only_samples <- select(ms_metadata_final, `sample-id`)
# joining the filtered sample ids with the manifest file
filtered_manifest <- left_join(filtered_metadata_only_samples, ms_manifest)
# exporting the filtered_manifest to a TSV file
filtered_manifest_filepath <- "filtered_ms_manifest.tsv"
write_tsv(filtered_manifest, filtered_manifest_filepath)
# exporting the filtered_manifest to a TSV file
filtered_manifest_filepath <- "filtered_ms_manifest_2.tsv"
write_tsv(filtered_manifest, filtered_manifest_filepath)
setwd("~/Desktop/GitHub/MICB475_24W1_Team_9/Data Filtering")
setwd("~/Desktop/GitHub/MICB475_24W1_Team_9/Data Filtering")
citations(phyloseq)
citation("phyloseq")
citation(microbiome)
citation("microbiome")
citation("ggVennDiagram")
