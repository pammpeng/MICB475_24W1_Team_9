library(tidyverse)
library(phyloseq)
library(microbiome)
library(ggVennDiagram)
#### Load Phyloseq Object ####
load("MS_phyloseq.RData")
# Convert to relative abundance
MS_RA <- transform_sample_counts(MS_phyloseq, fun=function(x) x/sum(x))
asthma_MS <- subset_samples(MS_RA, `Condition`=="Asthma_MS")
noasthma_MS <- subset_samples(MS_RA, `Condition`=="MS")
control <- subset_samples(MS_RA, `Condition`=="Control")
asthma_noMS <- subset_samples(MS_RA, `Condition`=="Asthma")
asthma_MS_ASVs <- core_members(asthma_MS, detection=0.001, prevalence = 0.5)
noasthma_MS_ASVs <- core_members(noasthma_MS, detection=0.001, prevalence = 0.5)
control_ASVs <- core_members(control, detection=0.001, prevalence = 0.5)
asthma_noMS_ASVs <- core_members(asthma_noMS, detection=0.001, prevalence = 0.5)
asthma_MS_ASVs
# What ASVs are found in more than 70% of samples in each antibiotic usage category?
# trying changing the prevalence to see what happens
asthma_MS_ASVs <- core_members(asthma_MS, detection=0.001, prevalence = 0.2)
asthma_MS_ASVs
# What ASVs are found in more than 70% of samples in each antibiotic usage category?
# trying changing the prevalence to see what happens
asthma_MS_ASVs <- core_members(asthma_MS, detection=0.01, prevalence = 0.5)
asthma_MS_ASVs
noasthma_MS_ASVs
control_ASVs
asthma_noMS_ASVs
asthma_MS_ASVs <- core_members(asthma_MS, detection=0.01, prevalence = 0.5)
noasthma_MS_ASVs <- core_members(noasthma_MS, detection=0.001, prevalence = 0.5)
control_ASVs <- core_members(control, detection=0.001, prevalence = 0.5)
asthma_noMS_ASVs <- core_members(asthma_noMS, detection=0.001, prevalence = 0.5)
prune_taxa(noasthma_MS_ASVs,MS_RA) %>%
plot_bar(fill="Genus") +
facet_wrap(.~`reported.antibiotic.usage`, scales ="free")
prune_taxa(noasthma_MS_ASVs,MS_RA) %>%
plot_bar(fill="Genus") +
facet_wrap(.~`Condition`, scales ="free")
condition_list_full <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs,
Control = control_ASVs, Asthma = asthma_noMS_ASVs)
# Create a Venn diagram using all the ASVs shared and unique to antibiotic users and non users
first_venn <- ggVennDiagram(x = condition_list_full)
first_venn
condition_list_MSvsControl <- list(Control = control_ASVs,MS = noasthma_MS_ASVs)
venn_MSvsControl <- ggVennDiagram(x = condition_list_MSvsControl)
venn_MSvsControl
condition_list_MSAsthmavsControl <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs)
venn_MSAsthmavsControl <- ggVennDiagram(x = condition_list_MSAsthmavsControl)
venn_MSAsthmavsControl
venn_MSAsthmavsControl <- ggVennDiagram(x = condition_list_MSAsthmavsControl) + coord_flip()
venn_MSAsthmavsControl
# Create a Venn diagram using all the ASVs shared and unique to antibiotic users and non users
venn_all <- ggVennDiagram(x = condition_list_all) + coord_flip()
venn_MSvsControl <- ggVennDiagram(x = condition_list_MSvsControl) + coord_flip()
condition_list_MSAsthmavsControl <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
condition_list_minus_asthma <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
condition_list_MSAsthmavsControl <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs)
venn_minu_Asthma <- ggVennDiagram(x = condition_list_minus_asthma) + coord_flip()
venn_minu_Asthma
venn_minu_Asthma <- ggVennDiagram(x = condition_list_minus_asthma)
venn_minu_Asthma
condition_list_MS_asthmavsno <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
venn_MS_asthmavsno <- ggVennDiagram(x = condition_list_MS_asthmavsno)
venn_MS_asthmavsno
venn_MS_asthmavsno <- ggVennDiagram(x = condition_list_MS_asthmavsno) + coord_flip()
venn_MS_asthmavsno
condition_taxa_plot <- prune_taxa(noasthma_MS_ASVs,MS_RA) %>%
plot_bar(fill="Genus") +
facet_wrap(.~`Condition`, scales ="free")
# Save Venn diagrams
ggsave("venn_all.png", venn_all)
# Create a Venn diagrams
venn_all <- ggVennDiagram(x = condition_list_all)
# Create lists of the variables to compare
condition_list_all <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs,
Control = control_ASVs, Asthma = asthma_noMS_ASVs)
# Create a Venn diagrams
venn_all <- ggVennDiagram(x = condition_list_all)
venn_all
# Save Venn diagrams
ggsave("venn_all.png", venn_all)
# Save Venn diagrams
ggsave("venn_all.png", venn_all)
# Create a Venn diagrams
venn_all <- ggVennDiagram(x = condition_list_all) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
# Save Venn diagrams
ggsave("venn_all.png", venn_all)
# Save Venn diagrams
ggsave("venn_all.png", venn_all, height = 4, width = 6)
# Save Venn diagrams
ggsave("venn_all.png", venn_all, height = 4, width = 8)
# Save Venn diagrams
ggsave("venn_all.png", venn_all, height = 6, width = 10)
venn_MSvsControl <- ggVennDiagram(x = condition_list_MSvsControl) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MSAsthmavsControl <- ggVennDiagram(x = condition_list_MSAsthmavsControl) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_minus_Asthma <- ggVennDiagram(x = condition_list_minus_asthma) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
ggsave("venn_MS_vs_Control.png", venn_MSvsControl)
ggsave("venn_MS_vs_Control.png", venn_MSvsControl, height = 4, width = 6)
ggsave("venn_MS_vs_Control.png", venn_MSvsControl, height = 4, width = 7)
ggsave("venn_MS_vs_Control.png", venn_MSvsControl, height = 6, width = 8)
ggsave("venn_MS_Asthma_vs_Control.png", venn_MSAsthmavsControl)
ggsave("venn_MS_Asthma_vs_Control.png", venn_MSAsthmavsControl, height = 6, width = 8)
ggsave("venn_minus_Asthma.png", venn_minus_Asthma)
#### Load Phyloseq Object ####
load("MS_phyloseq.RData")
#### Core Microbiome Analysis ####
# Convert absolute abundance to relative abundance
MS_RA <- transform_sample_counts(MS_phyloseq, fun=function(x) x/sum(x))
# Filter dataset by condition
asthma_MS <- subset_samples(MS_RA, `Condition`=="Asthma_MS")
noasthma_MS <- subset_samples(MS_RA, `Condition`=="MS")
control <- subset_samples(MS_RA, `Condition`=="Control")
asthma_noMS <- subset_samples(MS_RA, `Condition`=="Asthma")
# Determining ASVs present in 50% of samples
asthma_MS_ASVs <- core_members(asthma_MS, detection=0.01, prevalence = 0.5)
noasthma_MS_ASVs <- core_members(noasthma_MS, detection=0.001, prevalence = 0.5)
control_ASVs <- core_members(control, detection=0.001, prevalence = 0.5)
asthma_noMS_ASVs <- core_members(asthma_noMS, detection=0.001, prevalence = 0.5)
# Create plot of ASVs relative abundance
condition_taxa_plot <- prune_taxa(noasthma_MS_ASVs,MS_RA) %>%
plot_bar(fill="Genus") +
facet_wrap(.~`Condition`, scales ="free")
# Create lists of the variables to compare
condition_list_all <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs,
Control = control_ASVs, Asthma = asthma_noMS_ASVs)
condition_list_MSvsControl <- list(Control = control_ASVs,MS = noasthma_MS_ASVs)
condition_list_MSAsthmavsControl <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs)
condition_list_minus_asthma <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
condition_list_MS_asthmavsno <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
# Create a Venn diagrams
venn_all <- ggVennDiagram(x = condition_list_all) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MSvsControl <- ggVennDiagram(x = condition_list_MSvsControl) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MSAsthmavsControl <- ggVennDiagram(x = condition_list_MSAsthmavsControl) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_minus_Asthma <- ggVennDiagram(x = condition_list_minus_asthma) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MS_asthmavsno <- ggVennDiagram(x = condition_list_MS_asthmavsno) + coord_flip()
library(tidyverse)
library(phyloseq)
library(microbiome)
library(ggVennDiagram)
venn_MS_asthmavsno
venn_MS_asthmavsno <- ggVennDiagram(x = condition_list_MS_asthmavsno) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
ggsave("ven_MS.png", venn_MS_asthmavsno)
#Load Packages
library(tidyverse)
library(phyloseq)
library(microbiome)
library(ggVennDiagram)
#### Load Phyloseq Object ####
load("MS_phyloseq.RData")
#### Core Microbiome Analysis ####
# Convert absolute abundance to relative abundance
MS_RA <- transform_sample_counts(MS_phyloseq, fun=function(x) x/sum(x))
# Filter dataset by condition
asthma_MS <- subset_samples(MS_RA, `Condition`=="Asthma_MS")
noasthma_MS <- subset_samples(MS_RA, `Condition`=="MS")
control <- subset_samples(MS_RA, `Condition`=="Control")
asthma_noMS <- subset_samples(MS_RA, `Condition`=="Asthma")
# Determining ASVs present in 50% of samples
asthma_MS_ASVs <- core_members(asthma_MS, detection=0.01, prevalence = 0.5)
noasthma_MS_ASVs <- core_members(noasthma_MS, detection=0.001, prevalence = 0.5)
control_ASVs <- core_members(control, detection=0.001, prevalence = 0.5)
asthma_noMS_ASVs <- core_members(asthma_noMS, detection=0.001, prevalence = 0.5)
# Create plot of ASVs relative abundance
condition_taxa_plot <- prune_taxa(noasthma_MS_ASVs,MS_RA) %>%
plot_bar(fill="Genus") +
facet_wrap(.~`Condition`, scales ="free")
# Create lists of the variables to compare
condition_list_all <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs,
Control = control_ASVs, Asthma = asthma_noMS_ASVs)
condition_list_MSvsControl <- list(Control = control_ASVs,MS = noasthma_MS_ASVs)
condition_list_MSAsthmavsControl <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs)
condition_list_minus_asthma <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
condition_list_MS_asthmavsno <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
# Create a Venn diagrams
venn_all <- ggVennDiagram(x = condition_list_all) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MSvsControl <- ggVennDiagram(x = condition_list_MSvsControl) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MSAsthmavsControl <- ggVennDiagram(x = condition_list_MSAsthmavsControl) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_minus_Asthma <- ggVennDiagram(x = condition_list_minus_asthma) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MS_asthmavsno <- ggVennDiagram(x = condition_list_MS_asthmavsno) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
condition_list_controlvsasthma <- list(Control = control_ASVs, Asthma = asthma_noMS_ASVs)
venn_controlvsasthma <- ggVennDiagram(x = condition_list_controlvsasthma) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_controlvsasthma
ggsave("ven_control_vs_asthma.png", venn_controlvsasthma)
condition_list_asthmavsasmtha_MS <- list(Asthma = asthma_noMS_ASVs, Asthma_MS = asthma_MS_ASVs)
venn_asthmavsasthma_MS <- ggVennDiagram(x = condition_list_asthmavsasmtha_MS) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_asthmavsasthma_MS
# Determining ASVs present in 50% of samples
asthma_MS_ASVs <- core_members(asthma_MS, detection=0.001, prevalence = 0.5)
asthma_MS_ASVs <- core_members(asthma_MS, detection=0.001, prevalence = 0.5)
noasthma_MS_ASVs <- core_members(noasthma_MS, detection=0.001, prevalence = 0.5)
control_ASVs <- core_members(control, detection=0.001, prevalence = 0.5)
asthma_noMS_ASVs <- core_members(asthma_noMS, detection=0.001, prevalence = 0.5)
condition_list_all <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs,
Control = control_ASVs, Asthma = asthma_noMS_ASVs)
condition_list_MSvsControl <- list(Control = control_ASVs,MS = noasthma_MS_ASVs)
condition_list_MSAsthmavsControl <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs)
condition_list_minus_asthma <- list(Control = control_ASVs,Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
condition_list_MS_asthmavsno <- list(Asthma_MS = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
condition_list_controlvsasthma <- list(Control = control_ASVs, Asthma = asthma_noMS_ASVs)
condition_list_asthmavsasmtha_MS <- list(Asthma = asthma_noMS_ASVs, Asthma_MS = asthma_MS_ASVs)
venn_all <- ggVennDiagram(x = condition_list_all) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MSvsControl <- ggVennDiagram(x = condition_list_MSvsControl) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MSAsthmavsControl <- ggVennDiagram(x = condition_list_MSAsthmavsControl) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_minus_Asthma <- ggVennDiagram(x = condition_list_minus_asthma) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_MS_asthmavsno <- ggVennDiagram(x = condition_list_MS_asthmavsno) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_controlvsasthma <- ggVennDiagram(x = condition_list_controlvsasthma) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_asthmavsasthma_MS <- ggVennDiagram(x = condition_list_asthmavsasmtha_MS) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_asthmavsasthma_MS
ggsave("venn_all.png", venn_all, height = 6, width = 10)
ggsave("venn_MS_vs_Control.png", venn_MSvsControl, height = 6, width = 8)
ggsave("venn_MS_Asthma_vs_Control.png", venn_MSAsthmavsControl, height = 6, width = 8)
ggsave("venn_minus_Asthma.png", venn_minus_Asthma)
ggsave("ven_MS.png", venn_MS_asthmavsno)
ggsave("ven_control_vs_asthma.png", venn_controlvsasthma)
library(tidyverse)
library(phyloseq)
library(microbiome)
library(ggVennDiagram)
# Create lists of the variables to compare
condition_list_all <- list(MS + Asthma = asthma_MS_ASVs, MS = noasthma_MS_ASVs,
# Create lists of the variables to compare
condition_list_all <- list("MS + Asthma" = asthma_MS_ASVs, MS = noasthma_MS_ASVs,
Healthy = control_ASVs, Asthma = asthma_noMS_ASVs)
View(condition_list_all)
condition_list_MSvsControl <- list(Healthy = control_ASVs,MS = noasthma_MS_ASVs)
condition_list_MSAsthmavsControl <- list(Healthy = control_ASVs,"MS + Asthma" = asthma_MS_ASVs)
condition_list_minus_asthma <- list(Healthy = control_ASVs,"MS + Asthma" = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
condition_list_MS_asthmavsno <- list("MS + Asthma" = asthma_MS_ASVs, MS = noasthma_MS_ASVs)
condition_list_controlvsasthma <- list(Healthy = control_ASVs, Asthma = asthma_noMS_ASVs)
condition_list_asthmavsasmtha_MS <- list(Asthma = asthma_noMS_ASVs, "MS + Asthma" = asthma_MS_ASVs)
# Create a Venn diagrams
venn_all <- ggVennDiagram(x = condition_list_all) + theme_minimal()
# Save Venn diagrams
ggsave("venn_all.png", venn_all, height = 6, width = 10)
# Create a Venn diagrams
venn_all <- ggVennDiagram(x = condition_list_all) + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
# Save Venn diagrams
ggsave("venn_all.png", venn_all, height = 6, width = 10)
# Save Venn diagrams
ggsave("venn_all.png", venn_all, height = 6, width = 11)
# Save Venn diagrams
ggsave("venn_all.png", venn_all, height = 8, width = 12)
# Save Venn diagrams
ggsave("core_microbiome_venn.png", venn_all, height = 8, width = 12)
asthma_MS_ASVs
condition_list_MSvsControl
condition_list_asthmavsMS <- list(Asthma = asthma_noMS_ASVs, MS = noasthma_MS_ASVs)
venn_asthmavMS <- ggVennDiagram(x = condition_list_asthmavsMS) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
library(ggVennDiagram)
venn_asthmavMS <- ggVennDiagram(x = condition_list_asthmavsMS) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
library(tidyverse)
library(phyloseq)
library(microbiome)
library(ggVennDiagram)
venn_asthmavMS <- ggVennDiagram(x = condition_list_asthmavsMS) + coord_flip() + theme(
plot.background = element_rect(
fill = "white",
colour = "white"))
venn_asthmavMS
